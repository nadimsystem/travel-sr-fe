<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Online - Sutan Raya</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; }
        .ticket { background: linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%); border-radius: 1.5rem 1.5rem 0 0; }
        .ticket-cutout { position: relative; background: #fff; border-radius: 0 0 1.5rem 1.5rem; }
        .ticket-cutout:before, .ticket-cutout:after { content: ''; position: absolute; width: 2rem; height: 2rem; border-radius: 50%; top: -1rem; background: #f8fafc; }
        .ticket-cutout:before { left: -1rem; } .ticket-cutout:after { right: -1rem; }
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease; } .fade-enter-from, .fade-leave-to { opacity: 0; }
    </style>
</head>
<body>
    <div id="app" class="min-h-screen flex flex-col items-center justify-center p-4">
        <div class="text-center mb-8"><h1 class="text-4xl font-extrabold text-blue-900 mb-2">Sutan<span class="text-blue-600">Raya</span></h1><p class="text-gray-500">Booking Travel & Charter Online</p></div>
        <div class="bg-white w-full max-w-2xl rounded-3xl shadow-2xl border border-gray-100 overflow-hidden relative">
            <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-600 to-purple-600"></div>
            
            <div v-if="!ticketData" class="p-8 animate-fade-in">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div><label class="block text-xs font-bold text-gray-500 uppercase mb-1">Rute</label><select v-model="bookingForm.data.routeId" @change="calculatePrice" class="w-full border-gray-200 bg-gray-50 p-3 rounded-xl font-bold text-gray-700 outline-none"><option value="" disabled>-- Pilih Rute --</option><option v-for="r in routeConfig" :value="r.id">{{ r.origin }} -> {{ r.destination }}</option></select></div>
                    <div><label class="block text-xs font-bold text-gray-500 uppercase mb-1">Tanggal</label><input type="date" v-model="bookingForm.data.date" @change="resetSeatSelection" class="w-full border-gray-200 bg-gray-50 p-3 rounded-xl outline-none"></div>
                </div>
                <div v-if="bookingForm.data.routeId" class="space-y-6">
                    <div class="grid grid-cols-2 gap-4 bg-gray-100 p-1.5 rounded-xl"><button @click="setServiceType('Travel')" :class="bookingForm.data.serviceType==='Travel'?'bg-white shadow text-blue-700':'text-gray-500'" class="py-2.5 font-bold text-sm rounded-lg transition-all">Travel (Perorangan)</button><button @click="setServiceType('Dropping')" :class="bookingForm.data.serviceType==='Dropping'?'bg-white shadow text-blue-700':'text-gray-500'" class="py-2.5 font-bold text-sm rounded-lg transition-all">Charter (Sewa Unit)</button></div>
                    <div><label class="block text-xs font-bold text-gray-500 uppercase mb-2">Jam</label><div v-if="bookingForm.data.serviceType==='Travel'" class="grid grid-cols-4 gap-3"><button v-for="t in selectedRoute?.schedules" @click="bookingForm.data.time = t; resetSeatSelection()" :class="bookingForm.data.time===t?'bg-blue-600 text-white':'bg-gray-100 text-gray-600'" class="py-2 rounded-lg font-bold text-sm transition-all">{{t}}</button></div><div v-else><input type="time" v-model="bookingForm.data.time" class="w-full p-3 border-2 border-blue-100 rounded-xl text-xl font-bold text-blue-900 text-center"></div></div>
                    <div class="grid grid-cols-2 gap-4"><input type="text" v-model="bookingForm.data.passengerName" placeholder="Nama Lengkap" class="w-full border-gray-200 bg-gray-50 p-3 rounded-xl"><input type="text" v-model="bookingForm.data.passengerPhone" placeholder="No. WhatsApp" class="w-full border-gray-200 bg-gray-50 p-3 rounded-xl"></div>
                    <div v-if="bookingForm.data.serviceType==='Travel' && bookingForm.data.time" class="bg-gray-50 p-6 rounded-2xl border border-gray-200 flex flex-col items-center"><h4 class="font-bold text-gray-400 uppercase text-xs mb-4">Pilih Kursi (Hiace)</h4><div class="bg-white border-2 rounded-[2rem] p-5 w-64 relative shadow-sm"><div class="space-y-3"><div v-for="row in seatLayout" :key="row.row" class="flex justify-between"><div v-for="seat in row.seats" :key="seat.id"><div v-if="seat.type==='driver'" class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center text-gray-300 text-[10px]">Supir</div><button v-else @click="toggleSeat(seat.id)" :disabled="isSeatOccupied(seat.id)" class="w-10 h-10 rounded-lg font-bold text-sm border transition-all" :class="isSeatOccupied(seat.id)?'bg-black text-white':(isSeatSelected(seat.id)?'bg-blue-900 text-white':'bg-yellow-300')">{{seat.id}}</button></div></div></div></div><div class="flex gap-4 mt-4"><label class="text-sm"><input type="radio" value="Umum" v-model="bookingForm.data.passengerType" @change="calculatePrice"> Umum</label><label class="text-sm"><input type="radio" value="Pelajar" v-model="bookingForm.data.passengerType" @change="calculatePrice"> Pelajar</label></div></div>
                    <div v-if="bookingForm.data.serviceType==='Dropping'" class="bg-blue-50 p-6 rounded-2xl border border-blue-100 text-center"><h4 class="font-bold text-blue-900 mb-2">Layanan Charter Private</h4><label class="inline-flex items-center gap-2 bg-white px-4 py-2 rounded-lg border cursor-pointer shadow-sm"><input type="checkbox" v-model="bookingForm.data.isMultiStop" @change="calculatePrice" class="w-4 h-4 text-blue-600"><span class="text-sm font-bold text-gray-700">Multi-stop?</span></label></div>
                    <div class="space-y-3 pt-4 border-t"><input type="text" v-model="bookingForm.data.pickupMapUrl" placeholder="Link Google Maps (Wajib)" class="w-full border-gray-200 bg-gray-50 p-3 rounded-xl text-sm"><input type="text" v-model="bookingForm.data.pickupAddress" placeholder="Detail Alamat" class="w-full border-gray-200 bg-gray-50 p-3 rounded-xl text-sm"><input type="text" v-model="bookingForm.data.dropoffAddress" placeholder="Alamat Tujuan" class="w-full border-gray-200 bg-gray-50 p-3 rounded-xl text-sm"><div class="bg-blue-50 p-4 rounded-xl border border-blue-100 mt-4"><div class="text-xs font-bold text-blue-800 mb-2">Upload Bukti Transfer</div><input type="file" @change="handleFileUpload" class="w-full text-xs"></div></div>
                    <div class="flex justify-between items-center pt-6 border-t"><div><div class="text-xs text-gray-500 font-bold uppercase">Total Bayar</div><div class="text-3xl font-extrabold text-blue-900">{{ formatRupiah(bookingForm.data.totalPrice) }}</div></div><button @click="saveBooking" class="px-8 py-4 rounded-xl bg-blue-600 text-white font-bold shadow-lg hover:bg-blue-700 transition-transform active:scale-95">Booking Sekarang</button></div>
                </div>
            </div>

            <div v-if="ticketData" class="bg-white w-full max-w-md rounded-[2rem] shadow-2xl overflow-hidden relative animate-fade-in m-8">
                <div class="ticket p-8 text-white relative overflow-hidden"><div class="flex justify-between items-start mb-8 relative z-10"><div><div class="text-3xl font-bold tracking-tight">Sutan<span class="font-light">Raya</span></div><div class="text-[10px] opacity-80 uppercase tracking-widest mt-1 font-bold">E-Ticket</div></div><div class="text-right"><div class="text-[10px] opacity-60 uppercase font-bold">ID</div><div class="font-mono text-lg font-bold">#{{ ticketData.id.toString().slice(-6) }}</div></div></div><div class="flex justify-between items-end relative z-10"><div><div class="text-[10px] opacity-60 uppercase font-bold mb-1">Penumpang</div><div class="text-xl font-bold">{{ ticketData.passengerName }}</div></div><div class="text-right"><div class="text-[10px] opacity-60 uppercase font-bold mb-1">Jam</div><div class="text-xl font-bold">{{ ticketData.time }}</div></div></div></div>
                <div class="ticket-cutout bg-white p-8 pt-10"><div class="flex justify-between mb-5 border-b border-dashed border-gray-200 pb-5"><div><div class="text-xs text-gray-400 uppercase font-bold">Rute</div><div class="font-bold text-gray-800 text-sm">{{ getRouteName(ticketData.routeId) }}</div></div><div class="text-right"><div class="text-xs text-gray-400 uppercase font-bold">Tanggal</div><div class="font-bold text-gray-800 text-sm">{{ formatDate(ticketData.date) }}</div></div></div><div class="text-center mb-6"><p class="text-xs text-gray-500 mb-2">Status Pembayaran:</p><span v-if="ticketData.validationStatus==='Valid'" class="px-3 py-1 bg-green-100 text-green-700 font-bold rounded-full text-xs">LUNAS</span><span v-else class="px-3 py-1 bg-orange-100 text-orange-700 font-bold rounded-full text-xs">Menunggu Validasi</span></div><button @click="printTicket" class="w-full py-3 rounded-xl border-2 font-bold text-sm">Cetak Tiket</button><button @click="ticketData=null; bookingForm.data=getFreshData('Online')" class="w-full mt-3 text-xs text-blue-600 underline">Pesanan Baru</button></div>
            </div>
        </div>
    </div>
    <script src="app.js"></script>
</body>
</html>